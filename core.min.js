/* core.js v0.2.2 by @carlosgavina | hello@carlosgavina.com | https://github.com/carlosgavina/corejs */
(function(y,v){var n={typeOf:function(b){var c=typeof b;"object"===c&&null===b&&(null===b?c="null":"number"===typeof b.length&&(c="array"));return c},merge:function(b,c){var d={},a="object"===n.typeOf(b)?b:null,e="object"===n.typeOf(c)?c:null,k;if(a)for(k in a)d[k]=a[k];if(e)for(k in e)d[k]=e[k];return d}},h={_:{},Apps:{},Tools:n,Object:function(b){var c=this,d=n.typeOf,a=document.createElement("p"),e={_:{_:$(a)}},k=function(a,c,g){var b;c="string"===d(c)?c:"_";g="boolean"===d(g)?g:!0;if("string"===
d(a)){b=a.split(":");1===b.length?(a="_",b=b[0]):(a=b[0],b=b[1]);if("object"!==d(e[a])&&!0===g)e[a]={};else if("object"!==d(e[a]))return;if("object"!==d(e[a][c])&&!0===g)e[a][c]=$(document.createElement("p"));else if("object"!==d(e[a][c]))return;return{context:c,name:b,hub:e[a],event:e[a][c]}}};this._={};this._.clone=function(){Object.create||function(a){function c(){}c.prototype=a;return new c}};this._.implement=function(a){if(a)for(var d in a)a.hasOwnProperty(d)&&(c[d]=a[d]);return c};instance=
this._.clone(this);b&&this._.implement.call(instance,b);this.on=function(a,b,g){b="function"===typeof b?b:void 0;a=k(a,g);if("object"===d(a)&&"function"===d(b))a.event.on(a.name,$.proxy(b,c));return c};this.trigger=function(a,b,g){var e="string"===d(g)?g:"all";a=k(a,g,!1);if("object"===d(a))if("all"===e)for(var f in a.hub)a.hub[f].trigger(a.name,b);else a.event.trigger(a.name,b);return c};this.off=function(a,b){var g="string"===d(b)?b:"all",p=k(a,b,!1),f,j;if(void 0!==p)if(f=a.split(":"),f=1===f.length?
null:p.name,"all"===g)for(j in p.hub)p.hub[j].off(f);else p.event.off(f);else for(j in e)for(f in e[j])e[j][f].off();return c};return instance},Cache:function(b){var c={},d={},a={history:[],size:10,localStorage:!1,id:null},e=function(){var g;if("boolean"===typeof a.localStorage&&("string"===typeof a.id&&!0===a.localStorage&&0<a.id.length)&&"undefined"!==typeof localStorage)try{g=JSON.stringify(a.history),localStorage.setItem(a.id,g),c.trigger("LocalStorage:Save",{id:a.id,data:a.history})}catch(b){}};
if("object"===typeof b)for(var k in b)a[k]=b[k];var m;if("boolean"===typeof a.localStorage&&("string"===typeof a.id&&!0===a.localStorage&&0<a.id.length)&&"undefined"!==typeof localStorage)try{m=JSON.parse(localStorage.getItem(a.id)),"object"===typeof m&&void 0!==m.length&&(a.history=m)}catch(q){}d={add:function(g){var b=a.history.length,d=a.size;"undefined"!==typeof g&&("object"==typeof g&&g.length?(a.history=a.history.concat(g),b=a.history.length,b>=d&&a.history.splice(0,b-d)):(b>=d&&a.history.shift(),
a.history.push(g)));e();return c},get:function(){return a.history},remove:function(c){var b=a.history,d=a.history.length,k=!1;if("undefined"!==typeof c)for(;d--;)if(b[d]===c){a.history.splice(d,1);k=!0;break}e();return k},exists:function(c){var b=a.history,d=a.history.length;if("undefined"!==typeof c)for(;d--;)if(b[d]===c)return d;return!1},addUnique:function(b){var d=a.history,f=a.history.length;if("undefined"!==typeof b)for(;f--;)if(d[f]===b){a.history.splice(f,1);break}a.history.push(b);e();return c},
setMaxSize:function(b){a.size="number"===typeof b?b:detaults.size;return c},resetCache:function(){a.history=[];e()},removeAtIndex:function(c){if("number"===typeof c)return c<a.history.length?(a.history.splice(c,1),!0):!1;e()},setLocalStorage:function(c){a.localStorage="boolean"===typeof c?c:a.localStorage}};return c=new h.Object(d)},Api:function(b){var c,d={},a=n.typeOf,e=n.merge,k={protocol:"http://",timeout:1E4,async:!0},m={},q={},g=function(a,b,d,g){d.success=function(a){g.trigger("Success",a);
c.trigger("Success",a)};d.error=function(a,b){var d={error:{id:2,description:b,response:a.response,xhr:a}},e="Error";if("timeout"===b||"Timeout"===b)e="Timeout";g.trigger(e,d);c.trigger(e,d)};d.type=a;d.url=d.protocol+q.url+b.endpoint;a=$.ajax(d);g.request=a;return g},p=function(b,d,g){var f=null,j="Unknown";"string"===a(b)&&"object"===a(m[b])?(b="object"===a(m[b].options)?m[b].options:null,f=e(k,b),f=e(f,d)):("string"===a(b)&&(j=b),g.trigger("Error",{error:{id:1,description:"Request '"+j+"' doesn't exist."}}),
c.trigger("Error",{error:{id:1,description:"Request '"+j+"' doesn't exist."}}));return f},f;for(f in b)if("requests"!==f&&"url"!==f)k[f]=b[f];else if("requests"===f){var j=b[f];if("object"===a(j)){var l=void 0;for(l in j){var z=l,s=j[l];"string"===a(s.endpoint)&&(m[z]=s)}}else"string"===a(j)&&"string"===a(void 0)&&"string"===a((void 0).endpoint)&&(m[j]=void 0)}else"url"===f&&(q[f]=b[f]);d.post=function(a,b){var c=new h.Object,d=p(a,b,c);d&&g("POST",m[a],d,c);return c};d.get=function(a,b){var c=new h.Object,
d=p(a,b,c);d&&g("GET",m[a],d,c);return c};return c=new h.Object(d)},Controller:function(b){var c=n.typeOf;b="object"===c(b)?b:{};var d="string"===c(b.appname)?b.appname:null;d&&"object"===c(h.Apps[d])?b.app=h.Apps[d]:"object"===c(h._)&&"object"===c(h._.defapp)&&(b.app=h._.defapp);b=new h.Object(b);"function"===c(b.init)&&b.init(b);return b},Data:function(b){var c,d=n.typeOf,a=n.merge,e={},k=!1,m=function(b,k,f,j){var m="string"===d(e.request)?e.request:null,h="object"===d(e.app.Api)?e.app.Api:null,
q="string"===d(e.pushkey)?e.pushkey:null,t,n;f="object"===d(f)?f:{};var r="string"===d(f.method)?f.method:null,u;!r&&"push"===b?(r="post",u="object"===d(e.attributes)?e.attributes:{},f.data=u,t="boolean"===d(k)?k:!1,n="boolean"===d(j)?j:!1):!r&&"pull"===b&&(r="get",t="boolean"===d(k)?k:!0,n="boolean"===d(j)?j:!0);m&&h&&(request=h[r](m,f),request.on("Success",function(e,f){u=q&&"undefined"!==d(f[q])?f[q]:f;!0===n&&(u=a(u,c.attributes));!0===t&&c.set(u);c.trigger(b+":Success",u)}),request.on("Error",
function(a,d){c.trigger(b+":Error",d)}),request.on("Timeout",function(a,d){c.trigger(b+":Timeout",d)}));return c},q="string"===d(b.appname)?b.appname:null;b="object"===d(b)?b:{};e=a(b,{attributes:{}});q&&"object"===d(h.Apps[q])?e.app=h.Apps[q]:"object"===d(h._)&&"object"===d(h._.defapp)&&(e.app=h._.defapp);e.id&&e.attributes&&!k&&(k=new h.Cache({size:1,id:e.id,localStorage:!0}),k.get()[0]!=={}||""!==k.get()[0]?e.attributes=k.get()[0]:k.add(e.attributes));e.set=function(a,b){if("object"===typeof a)c.attributes=
a,c.trigger("Change",{newdata:a});else if("string"===typeof a)"object"!==d(c.attributes)&&(c.attributes={}),c.attributes[a]=b,c.trigger("Change:"+a,{newdata:b});else return!1;var f="string"===d(e.id)?e.id:null;f&&(k||(k=new h.Cache({size:1,id:f,localStorage:!0})),k.add(c.attributes));return c};e.get=function(a){var b=c.attributes;return"string"===typeof a?b[a]:b};e.pull=function(a,b,c){return m("pull",a,b,c)};e.push=function(a,b,c){return m("push",a,b,c)};c=new h.Object(e);"function"===d(c.init)&&
c.init(c);return c},Microtemplate:function(b){var c=/\{{([^}]+)\}}/g,d={render:function(b){b="object"===typeof b?b:{};b="object"===typeof b.variables?b.variables:void 0;b="object"===typeof b?b:"object"===typeof a.arg.variables?a.arg.variables:null;var e,h,g,p;e=a.template;var f=document.createElement(a.elType);if(b&&"string"===typeof e){h=e.match(c);if(null!==h)for(var j=g=h.length;j--;)g=h[j],p=h[j].slice(2,h[j].length-2),e=e.replace(g,b[p]);a.rendered=e;f.innerHTML=e;a.el=$(e);d.onDone()}else"string"===
typeof e&&(a.rendered=e,f.innerHTML=e,a.el=$(e),d.onDone());return a},onDone:function(){"function"===typeof a.arg.render&&a.arg.render(a)},getT:function(b){"undefined"!==typeof("string"===typeof a.template?a.template:void 0)&&!1===b?("function"===typeof a.arg.loaded&&a.arg.loaded(a),"function"===typeof d.onDone&&d.render(a)):"string"===typeof a.url&&$.ajax({url:a.url+"?v="+a.version,async:!0,success:function(b){a.template=b;a.el=$(b);"function"===typeof a.arg.loaded&&a.arg.loaded(a);"function"===
typeof d.onDone&&d.render(a.template)},error:function(){return null}})}},a={elType:"div",arg:b,url:void 0,template:void 0,rendered:void 0,version:0,render:d.render},e="boolean"===typeof b.force?b.force:!1;a.arg=b;"string"===typeof b.html?(a.template=b.html,"function"===typeof b.loaded&&b.loaded(a),d.render()):"string"===typeof b.url&&(a.url=b.url,d.getT(e));a.version="number"===typeof b.version?b.version:"object"===typeof h._&&"object"===typeof h._.defapp&&"object"===typeof h._.defapp.config&&"object"===
typeof h._.defapp.config.versions&&"number"===typeof h._.defapp.config.versions.templates?h._.defapp.config.versions.templates:1;return a},View:function(b){return new function(){var c=new h.Object,d={},a,e,k=function(a){try{return a instanceof HTMLElement}catch(b){return"object"===typeof a&&1===a.nodeType&&"object"===typeof a.style&&"object"===typeof a.ownerDocument}},m=function(b){var f,h="object"===typeof b?b:{},j="function"===typeof h.onSuccess?h.onSuccess:function(){};gatherElements=function(a){if(g){g.html(a);
for(var b in d)p[b]=g.find(d[b])}c.elements=p};if(!0===e)f=a.render(b),c.template=f,gatherElements(f.el),j(c),c.trigger("TemplateRendered",c);else c.on("TemplateReady",function(a,b){f=b;c.template=f;gatherElements(f.el);j(c);(void 0).trigger("TemplateRendered",c)});return c},q=function(a,b){var d="string"===typeof a?a:null,e="string"===typeof b||"number"===typeof b?b:"",f,g=null,h;d&&(d=d.split(":"),f=d[0],"string"===typeof d[1]&&(g=d[1]),"undefined"!==typeof p[f]&&k(p[f][0])?h=p[f]:"string"===f&&
(h=$(f)),null===g?h.html(e):h.attr(g,e));return c},g=null,p={},f=h,j=f.Apps,l="object"===typeof b?b:{},n="string"===typeof l.html?l.html:null,s="string"===typeof l.url?l.url:null,t="string"===typeof l.storageID?l.storageID:null,w="boolean"===typeof l.appstorage?l.appstorage:!0,r="string"===typeof l.appname?l.appname:null;e=!1;!0===w&&t&&(!r&&"object"===typeof f._.defapp&&(r=f._.defapp.name),r&&("object"===typeof j&&"object"===typeof j[r])&&(f=j[r],f._.getTemplate(t,{url:s,html:n,loaded:function(b){a=
b;e=!0;c.trigger("TemplateReady",a)}})));d="object"===typeof l.elements?l.elements:{};return function(a){a="object"===typeof a?a:{};g="object"===typeof a.el&&k(a.el[0])?a.el:"string"===typeof a.el?$(a.el):null;c.el=g;c.render=m;c.update=q;c.elements=p;c.events=void 0;return c}}},App:function(b){var c=new h.Object,d={Router:{Default:""}},a={},e={},k=h.Microtemplate,m=function(b,c,e){var f="object"===typeof a.Templates.get()[0]?a.Templates.get()[0]:!1,g=d.versions.templates;if(!f||"object"!==typeof f.templates)f=
{templates:{}},f.version=g;f.templates[b]={version:e,html:c};a.Templates.add(f)},q=function(a){var b=e;a=a.split("/");var c=!1,d={};""===a[0]&&a.splice(0,1);""===a[a.length-1]&&(a=a.splice(a.length-1,1));request_split_len=a.length;for(var f in b){if(request_split_len===b[f].len){for(var c=!0,g=0;g<request_split_len;g++)a[g].toLowerCase()!==b[f].split[g].toLowerCase()&&(c=!1);if(!1===c)for(g=0;g<request_split_len;g++)a[g].toLowerCase()===b[f].split[g].toLowerCase()||void 0!==b[f].variables[g]?(void 0!==
b[f].variables[g]&&(d[b[f].variables[g]]=a[g]),c=!0):c=!1}if(!0===c)return{key:f,variables:d}}return!1},g="object"===typeof b?b:{};b="string"===typeof g.name?g.name:Math.random().toString(36).substring(7);var p="undefined"!==typeof g.el&&isElement(g.el[0])?g.el:$("body"),f="boolean"===typeof g.localStorage?g.localStorage:!1,j="object"===typeof g.versions?g.versions:{},l=b+"_data";j.templates="number"===typeof j.templates?j.templates:1;j.data="number"===typeof j.data?j.data:1;if(g)for(var n in g)d[n]=
g[n];d.versions=j;a.Templates=new h.Cache({size:1,id:b+"_templates",localStorage:f});a.Data=new h.Cache({size:1,id:l,localStorage:f});h._.defapp=c;h.Apps[b]=c;n=d.Router;var g={},s,t,w={},r,u=/\{([^}]+)\}/g;if("object"===typeof n){for(var v in n){f=n[v];l=f.split("/");""===l[0]&&l.splice(0,1);""===l[l.length-1]&&(l=l.splice(l.length-1,1));t=l.length;s=f.match(u);j=[];if(s)for(var x=r=0;x<t;x++)s=l[x].match(u)?l[x]:void 0,void 0!==s?(s=s.substr(1,s.length-2),j.push(s),w[s]=void 0,r++):j.push(void 0);
g[v]={route:f,len:t,split:l,variables:j,varkeys:w}}e=g}c.el=p;c.name=b;c.services={};c.start=function(){var a=function(a){var b=a.substr(1,a.length-1);a=""===a?{key:"Default",variables:{}}:q(b);c.trigger("Router:"+a.key,{variables:a.variables,self:c})};if("onhashchange"in window)window.onhashchange=function(){a(window.location.hash)};else{var b=window.location.hash,d;window.setInterval(function(){window.location.hash!=b&&(d=window.location.hash,a(d))},100)}a(window.location.hash);return c};c.config=
d;c.translateRoute=q;d.Api&&(c.Api=new $$.Api(d.Api));c.Data="object"===typeof d.Data?d.Data:{};c.Views="object"===typeof d.Views?d.Views:{};c._={saveTemplate:m,getTemplate:function(b,c){var f="object"===typeof c?c:{},e="object"===typeof a.Templates.get()[0]?a.Templates.get()[0]:!1,g=d.versions.templates,h="number"===typeof f.version?f.version:1,j="function"===typeof c.loaded?c.loaded:!1,f=!0;if(e)if("number"===typeof e.version&&e.version===g){if("object"===typeof e.templates&&"object"===typeof e.templates[b]){f=
!1;var e=e.templates[b],g="string"===typeof e.html?e.html:"...",l="function"===typeof c.loaded?c.loaded:!1;("number"===typeof e.version?e.version:1)===h?(c.url=null,c.html=g):c.loaded=function(a){m(b,a.template,h);l&&l(a)};e=new k(c);return e}}else a.Templates.resetCache();if(!0===f)return c.loaded=function(a){m(b,a.template,h);j&&j(a)},new k(c,!0)},saveData:function(){},getData:function(){}};return c}};"function"===typeof define&&define.amd?define("Core",[],function(){return h}):"undefined"!==typeof module&&
"undefined"!==typeof exports&&module.exports?module.exports=h:y["string"===typeof v?v:"Core"]=h})(this,"$$");
